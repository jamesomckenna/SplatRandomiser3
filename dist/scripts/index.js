window.addEventListener("load",(e=>{console.log("Page Loaded");let t,n,a,s,d=document.getElementById("main_shell"),l=document.getElementById("randomise_btn"),i=document.getElementById("weapon_name"),o=document.getElementById("weapon_img"),c=document.getElementById("sub_name"),m=document.getElementById("sub_img"),r=document.getElementById("special_name"),h=document.getElementById("special_img"),g=document.getElementById("special_points"),_=document.getElementById("stat_name_1"),p=document.getElementById("stat_name_2"),u=document.getElementById("stat_name_3"),y=document.getElementById("stat_val_1"),E=document.getElementById("stat_val_2"),b=document.getElementById("stat_val_3"),L=document.getElementById("loading_screen"),f=document.getElementById("loading_bar"),w=document.getElementById("loading_value"),j=document.getElementById("side_menu_content"),k=document.getElementById("weapon_select_btn"),I=document.getElementById("side_menu_close"),C=document.getElementById("weapon_select_container"),B=document.getElementsByClassName("weapon_card_weapon"),v=document.getElementsByClassName("weapon_card_class"),M=[],H=[];function T(e,t){return e.name<t.name?-1:e.name>t.name?1:0}function O(e,t,n){let a=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div"),l=document.createElement("div");return a.classList.add("weapon_card_container"),a.dataset.class=e,a.dataset.selected="true",s.classList.add("weapon_card_shell"),d.classList.add("weapon_card"),d.classList.add("weapon_card_class"),d.dataset.selected="true",d.dataset.class=e,n.classList.add("weapon_card_img"),l.classList.add("weapon_card_name"),l.innerHTML="ALL<br>"+t.toUpperCase()+"<br>ON",d.appendChild(n),d.appendChild(l),s.appendChild(d),a.appendChild(s),C.appendChild(a),a}function N(){let e=[];for(let t=0;t<B.length;t++){let n=B[t].dataset.id;"true"==B[t].dataset.selected&&e.push(n)}if(e.length>0){let d=Math.floor(Math.random()*e.length),l=t[e[d]];i.innerHTML=l.name,o.firstElementChild&&o.removeChild(o.firstElementChild),o.appendChild(l.img_obj);let L=n[l.sub];c.innerHTML=L.name,m.firstElementChild&&m.removeChild(m.firstElementChild),m.appendChild(L.img_obj);let f=a[l.special];r.innerHTML=f.name,h.firstElementChild&&h.removeChild(h.firstElementChild),h.appendChild(f.img_obj);let w=s[l.class];_.innerHTML=w.stat_name[0],p.innerHTML=w.stat_name[1],u.innerHTML=w.stat_name[2],y.style.width=l.stats[0]+"%",E.style.width=l.stats[1]+"%",b.style.width=l.stats[2]+"%",g.innerHTML=l.points+"p"}else console.log("Error: No weapons to choose from")}function U(){j.classList.remove("open")}M.push(fetch("dist/json/weapons.json").then((e=>e.json())).then((e=>t=e))),M.push(fetch("dist/json/subs.json").then((e=>e.json())).then((e=>n=e))),M.push(fetch("dist/json/specials.json").then((e=>e.json())).then((e=>a=e))),M.push(fetch("dist/json/classes.json").then((e=>e.json())).then((e=>s=e))),Promise.all(M).then((e=>{console.log("Data Loaded");let d=0,i=t.length+Object.keys(n).length+Object.keys(a).length+Object.keys(s).length;for(key in s)s[key].img_obj=new Image(90,90),s[key].img_obj.alt=s[key].name,s[key].img_obj.src="dist/images/class/"+s[key].img+".webp",H.push(s[key].img_obj.decode().then((()=>{o()})));for(key in t.sort(T),t.forEach(((e,n)=>{let a="dist/images/weapons/"+e.img+".webp";t[n].img_obj=new Image(205,205),t[n].img_obj.alt=e.name,t[n].img_obj.src=a,H.push(t[n].img_obj.decode().then((()=>{o()})))})),n)n[key].img_obj=new Image(71,71),n[key].img_obj.alt=n[key].name,n[key].img_obj.src="dist/images/sub/"+n[key].img+".webp",H.push(n[key].img_obj.decode().then((()=>{o()})));for(key in a)a[key].img_obj=new Image(71,71),a[key].img_obj.alt=a[key].name,a[key].img_obj.src="dist/images/special/"+a[key].img+".webp",H.push(a[key].img_obj.decode().then((()=>{o()})));function o(){d++;let e=Math.floor(d/i*100)+"%";f.style.width=e,w.innerHTML=e}Promise.all(H).then((e=>{for(key in console.log("Images Loaded"),s)s[key].container=O(key,s[key].name,s[key].img_obj);t.forEach(((e,n)=>{!function(e,t,n,a){let s=document.createElement("div"),d=document.createElement("div"),l=new Image(90,90),i=document.createElement("div");s.classList.add("weapon_card_shell"),d.classList.add("weapon_card"),d.classList.add("weapon_card_weapon"),d.dataset.selected="true",d.dataset.id=e,l.alt=t,l.src=n,l.classList.add("weapon_card_img"),i.classList.add("weapon_card_name"),i.innerHTML=t,d.appendChild(l),d.appendChild(i),s.appendChild(d),a.appendChild(s)}(n,e.name,t[n].img_obj.src,s[t[n].class].container)}));for(let e=0;e<B.length;e++)B[e].addEventListener("click",(function(){"true"==this.dataset.selected?this.dataset.selected="false":this.dataset.selected="true"}));for(let e=0;e<v.length;e++)v[e].addEventListener("click",(function(){let e="";"true"==this.dataset.selected?(this.dataset.selected="false",e="OFF"):(this.dataset.selected="true",e="ON"),this.children[1].innerHTML="ALL <br>"+this.dataset.class.toUpperCase()+"<br>"+e;let n=this.dataset.class,a=this.dataset.selected;for(let e=0;e<B.length;e++)t[B[e].dataset.id].class!=n&&"weapons"!=n||(B[e].dataset.selected=a);if("weapons"==n)for(let t=0;t<v.length;t++)v[t].dataset.selected=a,v[t].children[1].innerHTML="ALL <br>"+v[t].dataset.class.toUpperCase()+"<br>"+e}));N(),l.disabled=!1,L.style.display="none"}))})).catch((e=>{console.log("Error: Unable to obtain data",e)})),l.addEventListener("click",(function(){N()})),k.addEventListener("click",(function(){j.classList.add("open")})),I.addEventListener("click",(function(){U()})),d.addEventListener("click",(function(){U()}))}));