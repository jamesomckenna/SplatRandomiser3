window.addEventListener("load",(e=>{console.log("Page Loaded");let t,n,a,s,d=document.getElementById("main_shell"),l=document.getElementById("randomise_btn"),o=document.getElementById("weapon_name"),i=document.getElementById("weapon_img"),c=document.getElementById("sub_name"),m=document.getElementById("sub_img"),r=document.getElementById("special_name"),g=document.getElementById("special_img"),h=document.getElementById("special_points"),p=document.getElementById("stat_name_1"),_=document.getElementById("stat_name_2"),u=document.getElementById("stat_name_3"),y=document.getElementById("stat_val_1"),b=document.getElementById("stat_val_2"),E=document.getElementById("stat_val_3"),f=document.getElementById("loading_screen"),w=document.getElementById("loading_bar"),L=document.getElementById("loading_value"),j=document.getElementById("side-menu__content"),k=document.getElementById("weapon_select_btn"),I=document.getElementById("side-menu__close"),B=document.getElementById("weapon_select_container"),C=document.getElementsByClassName("weapon_card_weapon"),v=document.getElementsByClassName("weapon_card_class"),M=[],H=[];function T(e,t){return e.name<t.name?-1:e.name>t.name?1:0}function O(e,t,n){let a=document.createElement("div"),s=document.createElement("button"),d=document.createElement("div");return a.classList.add("weapon_card_container"),a.dataset.class=e,a.dataset.selected="true",s.classList.add("weapon_card"),s.classList.add("weapon_card_class"),s.dataset.selected="true",s.dataset.class=e,n.classList.add("weapon_card_img"),d.classList.add("weapon_card_name"),d.innerHTML="ALL<br>"+t.toUpperCase()+"<br>ON",s.appendChild(n),s.appendChild(d),a.appendChild(s),B.appendChild(a),a}function N(){let e=[];for(let t=0;t<C.length;t++){let n=C[t].dataset.id;"true"==C[t].dataset.selected&&e.push(n)}if(e.length>0){let d=Math.floor(Math.random()*e.length),l=t[e[d]];o.innerHTML=l.name,i.firstElementChild&&i.removeChild(i.firstElementChild),i.appendChild(l.img_obj);let f=n[l.sub];c.innerHTML=f.name,m.firstElementChild&&m.removeChild(m.firstElementChild),m.appendChild(f.img_obj);let w=a[l.special];r.innerHTML=w.name,g.firstElementChild&&g.removeChild(g.firstElementChild),g.appendChild(w.img_obj);let L=s[l.class];p.innerHTML=L.stat_name[0],_.innerHTML=L.stat_name[1],u.innerHTML=L.stat_name[2],y.style.width=l.stats[0]+"%",b.style.width=l.stats[1]+"%",E.style.width=l.stats[2]+"%",h.innerHTML=l.points+"p"}else console.log("Error: No weapons to choose from")}function U(){j.classList.remove("open")}M.push(fetch("dist/json/weapons.json").then((e=>e.json())).then((e=>t=e))),M.push(fetch("dist/json/subs.json").then((e=>e.json())).then((e=>n=e))),M.push(fetch("dist/json/specials.json").then((e=>e.json())).then((e=>a=e))),M.push(fetch("dist/json/classes.json").then((e=>e.json())).then((e=>s=e))),Promise.all(M).then((e=>{console.log("Data Loaded");let d=0,o=t.length+Object.keys(n).length+Object.keys(a).length+Object.keys(s).length;for(key in s)s[key].img_obj=new Image(90,90),s[key].img_obj.alt=s[key].name,s[key].img_obj.src="dist/images/class/"+s[key].img+".webp",H.push(s[key].img_obj.decode().then((()=>{i()})));for(key in t.sort(T),t.forEach(((e,n)=>{let a="dist/images/weapons/"+e.img+".webp";t[n].img_obj=new Image(205,205),t[n].img_obj.alt=e.name,t[n].img_obj.src=a,H.push(t[n].img_obj.decode().then((()=>{i()})))})),n)n[key].img_obj=new Image(71,71),n[key].img_obj.alt=n[key].name,n[key].img_obj.src="dist/images/sub/"+n[key].img+".webp",H.push(n[key].img_obj.decode().then((()=>{i()})));for(key in a)a[key].img_obj=new Image(71,71),a[key].img_obj.alt=a[key].name,a[key].img_obj.src="dist/images/special/"+a[key].img+".webp",H.push(a[key].img_obj.decode().then((()=>{i()})));function i(){d++;let e=Math.floor(d/o*100)+"%";w.style.width=e,L.innerHTML=e}Promise.all(H).then((e=>{for(key in console.log("Images Loaded"),s)s[key].container=O(key,s[key].name,s[key].img_obj);t.forEach(((e,n)=>{!function(e,n,a){let s=document.createElement("button"),d=new Image(90,90),l=document.createElement("div");s.classList.add("weapon_card"),s.classList.add("weapon_card_weapon"),s.dataset.selected="true",s.dataset.id=e,d.alt=n,d.src="dist/images/weapons/"+t[e].img+"-small.webp",d.classList.add("weapon_card_img"),l.classList.add("weapon_card_name"),l.innerHTML=n,s.appendChild(d),s.appendChild(l),a.appendChild(s)}(n,e.name,s[t[n].class].container)}));for(let e=0;e<C.length;e++)C[e].addEventListener("click",(function(){"true"==this.dataset.selected?this.dataset.selected="false":this.dataset.selected="true"}));for(let e=0;e<v.length;e++)v[e].addEventListener("click",(function(){let e="";"true"==this.dataset.selected?(this.dataset.selected="false",e="OFF"):(this.dataset.selected="true",e="ON"),this.children[1].innerHTML="ALL <br>"+this.dataset.class.toUpperCase()+"<br>"+e;let n=this.dataset.class,a=this.dataset.selected;for(let e=0;e<C.length;e++)t[C[e].dataset.id].class!=n&&"weapons"!=n||(C[e].dataset.selected=a);if("weapons"==n)for(let t=0;t<v.length;t++)v[t].dataset.selected=a,v[t].children[1].innerHTML="ALL <br>"+v[t].dataset.class.toUpperCase()+"<br>"+e}));N(),l.disabled=!1,f.style.display="none"}))})).catch((e=>{console.log("Error: Unable to obtain data",e)})),l.addEventListener("click",(function(){N()})),k.addEventListener("click",(function(){j.classList.add("open")})),I.addEventListener("click",(function(){U()})),d.addEventListener("click",(function(){U()}))}));