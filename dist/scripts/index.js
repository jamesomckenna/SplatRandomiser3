window.addEventListener("load",(e=>{console.log("Page Loaded");let t,n,s,a,d=document.getElementById("main"),i=document.getElementById("randomise_btn"),l=document.getElementById("weapon_name"),o=document.getElementById("weapon_img"),m=document.getElementById("sub_name"),c=document.getElementById("sub_img"),r=document.getElementById("special_name"),g=document.getElementById("special_img"),u=document.getElementById("special_points"),h=document.getElementById("stat_name_1"),p=document.getElementById("stat_name_2"),y=document.getElementById("stat_name_3"),_=document.getElementById("stat_val_1"),b=document.getElementById("stat_val_2"),E=document.getElementById("stat_val_3"),f=document.getElementById("loading_screen"),L=document.getElementById("loading_bar"),w=document.getElementById("loading_value"),k=document.getElementById("side-menu"),j=document.getElementById("side_menu_open"),I=document.getElementById("side_menu_close"),B=document.getElementById("side_menu_background"),C=document.getElementById("weapon_select_container"),v=document.getElementsByClassName("weapon-card--weapon"),M=document.getElementsByClassName("weapon-card--class"),H=[],T=[];function A(e,t){return e.name<t.name?-1:e.name>t.name?1:0}function O(e,t,n){let s=document.createElement("div"),a=document.createElement("button"),d=document.createElement("span");return s.classList.add("weapon-class"),s.dataset.class=e,a.classList.add("weapon-card"),a.classList.add("weapon-card--class"),a.dataset.selected="true",a.dataset.class=e,n.classList.add("weapon-card__img"),d.classList.add("weapon-card__name"),d.innerHTML="ALL<br>"+t.toUpperCase()+"<br>ON",a.appendChild(n),a.appendChild(d),s.appendChild(a),C.appendChild(s),s}function N(){let e=[];for(let t=0;t<v.length;t++){let n=v[t].dataset.id;"true"==v[t].dataset.selected&&e.push(n)}if(e.length>0){let d=Math.floor(Math.random()*e.length),i=t[e[d]];l.innerHTML=i.name,o.firstElementChild&&o.removeChild(o.firstElementChild),o.appendChild(i.img_obj);let f=n[i.sub];m.innerHTML=f.name,c.firstElementChild&&c.removeChild(c.firstElementChild),c.appendChild(f.img_obj);let L=s[i.special];r.innerHTML=L.name,g.firstElementChild&&g.removeChild(g.firstElementChild),g.appendChild(L.img_obj);let w=a[i.class];h.innerHTML=w.stat_name[0],p.innerHTML=w.stat_name[1],y.innerHTML=w.stat_name[2],_.style.width=i.stats[0]+"%",b.style.width=i.stats[1]+"%",E.style.width=i.stats[2]+"%",u.innerHTML=i.points+"p"}else console.log("Error: No weapons to choose from")}function U(){k.classList.remove("open"),k.setAttribute("inert",""),d.removeAttribute("inert"),j.removeAttribute("inert")}H.push(fetch("dist/json/weapons.json").then((e=>e.json())).then((e=>t=e))),H.push(fetch("dist/json/subs.json").then((e=>e.json())).then((e=>n=e))),H.push(fetch("dist/json/specials.json").then((e=>e.json())).then((e=>s=e))),H.push(fetch("dist/json/classes.json").then((e=>e.json())).then((e=>a=e))),Promise.all(H).then((e=>{console.log("Data Loaded");let d=0,l=t.length+Object.keys(n).length+Object.keys(s).length+Object.keys(a).length;for(key in a)a[key].img_obj=new Image(90,90),a[key].img_obj.alt=a[key].name,a[key].img_obj.src="dist/images/class/"+a[key].img+".webp",T.push(a[key].img_obj.decode().then((()=>{o()})));for(key in t.sort(A),t.forEach(((e,n)=>{let s="dist/images/weapons/"+e.img+".webp";t[n].img_obj=new Image(205,205),t[n].img_obj.alt=e.name,t[n].img_obj.src=s,T.push(t[n].img_obj.decode().then((()=>{o()})))})),n)n[key].img_obj=new Image(71,71),n[key].img_obj.alt=n[key].name,n[key].img_obj.src="dist/images/sub/"+n[key].img+".webp",T.push(n[key].img_obj.decode().then((()=>{o()})));for(key in s)s[key].img_obj=new Image(71,71),s[key].img_obj.alt=s[key].name,s[key].img_obj.src="dist/images/special/"+s[key].img+".webp",T.push(s[key].img_obj.decode().then((()=>{o()})));function o(){d++;let e=Math.floor(d/l*100)+"%";L.style.width=e,w.innerHTML=e}Promise.all(T).then((e=>{for(key in console.log("Images Loaded"),a)a[key].container=O(key,a[key].name,a[key].img_obj);t.forEach(((e,n)=>{!function(e,n,s){let a=document.createElement("button"),d=new Image(90,90),i=document.createElement("span");a.classList.add("weapon-card"),a.classList.add("weapon-card--weapon"),a.dataset.selected="true",a.dataset.id=e,d.alt="",d.src="dist/images/weapons/"+t[e].img+"-small.webp",d.classList.add("weapon-card__img"),d.setAttribute("loading","lazy"),i.classList.add("weapon-card__name"),i.innerHTML=n,a.appendChild(d),a.appendChild(i),s.appendChild(a)}(n,e.name,a[t[n].class].container)}));for(let e=0;e<v.length;e++)v[e].addEventListener("click",(function(){"true"==this.dataset.selected?this.dataset.selected="false":this.dataset.selected="true"}));for(let e=0;e<M.length;e++)M[e].addEventListener("click",(function(){let e="";"true"==this.dataset.selected?(this.dataset.selected="false",e="OFF"):(this.dataset.selected="true",e="ON"),this.children[1].innerHTML="ALL <br>"+this.dataset.class.toUpperCase()+"<br>"+e;let n=this.dataset.class,s=this.dataset.selected;for(let e=0;e<v.length;e++)t[v[e].dataset.id].class!=n&&"weapons"!=n||(v[e].dataset.selected=s);if("weapons"==n)for(let t=0;t<M.length;t++)M[t].dataset.selected=s,M[t].children[1].innerHTML="ALL <br>"+M[t].dataset.class.toUpperCase()+"<br>"+e}));N(),i.disabled=!1,f.style.display="none"}))})).catch((e=>{console.log("Error: Unable to obtain data",e)})),i.addEventListener("click",(function(){N()})),j.addEventListener("click",(function(){k.classList.add("open"),k.removeAttribute("inert"),d.setAttribute("inert",""),j.setAttribute("inert","")})),I.addEventListener("click",(function(){U()})),B.addEventListener("click",(function(){U()})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&U()}))}));